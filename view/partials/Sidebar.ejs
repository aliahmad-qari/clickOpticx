<script>
  const color = () => {
    const r = Math.floor(Math.random() * 256);
    const g = Math.floor(Math.random() * 256);
    const b = Math.floor(Math.random() * 256);
    const a = 0.8;
    return `rgba(${r}, ${g}, ${b})`;
  };

  // When DOM is fully loaded
  window.addEventListener('DOMContentLoaded', () => {
    const icons = document.querySelectorAll('.dynamic-color-icon');
    icons.forEach(icon => {
      icon.style.color = color();
    });
  });
</script>



<style>
  /* ===== RESPONSIVE SIDEBAR ===== */
  @media (max-width: 991px) {
    .sidebar {
      position: fixed !important;
      left: -250px;
      top: 0;
      height: 100vh;
      width: 250px;
      z-index: 9999;
      transition: left 0.3s ease;
      background: #ffffff;
    }

    .sidebar.active {
      left: 0;
    }

    .main-panel {
      margin-left: 0 !important;
      width: 100% !important;
    }

    .sidebar-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 9998;
      display: none;
    }

    .sidebar-overlay.active {
      display: block;
    }
  }

  @media (max-width: 576px) {
    .sidebar {
      width: 280px;
    }

    .nav-link {
      padding: 12px 15px !important;
      font-size: 0.9rem;
    }

    .menu-title {
      font-size: 0.9rem;
    }

    .sub-menu .nav-link {
      padding: 8px 25px !important;
      font-size: 0.85rem;
    }
  }

  /* ===== RESPONSIVE NAVIGATION ===== */
  @media (max-width: 991px) {
    .navbar .navbar-menu-wrapper {
      padding-left: 15px;
      padding-right: 15px;
    }

    .navbar-toggler {
      display: block !important;
      border: none;
      background: transparent;
      color: #333;
      font-size: 1.5rem;
      padding: 0.25rem 0.5rem;
    }
  }
</style>

<% if(isAdmin){ %>
  <!-- Sidebar Overlay for Mobile -->
  <div class="sidebar-overlay" id="sidebarOverlay" data-toggle="offcanvas"></div>

  <nav class="sidebar sidebar-offcanvas" id="sidebar">
    <ul class="nav">

      <li class="nav-item">
        <a class="nav-link" href="/adminIndex">
          <i class="icon-grid menu-icon dynamic-color-icon"></i>
          <span class="menu-title">Dashboard</span>
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link gap-1" style="padding: 14px;" data-toggle="collapse" href="#ui-basic" aria-expanded="false"
          aria-controls="ui-basic">
          <i class="mdi mdi-account-box-outline dynamic-color-icon"></i>
          <span class="menu-title">User Management</span>
          <i class="menu-arrow"></i>
        </a>
        <div class="collapse" id="ui-basic">
          <ul class="nav flex-column sub-menu" style="padding: 0.25rem 0 0; list-style: none !important;">
            <li class="nav-item"> <a class="nav-link" href="/AdminUser"><i class="mdi mdi-account "></i>All Users</a>
            </li>
            <li class="nav-item"> <a class="nav-link" href="/AddUser"><i class="mdi mdi-account-plus "></i> Add
                Users</a></li>
            <li class="nav-item"> <a class="nav-link" href="/ActiveUser"><i class="mdi mdi-account-check "></i> Active
                Users</a></li>
            <li class="nav-item"> <a class="nav-link" href="/ExpiredUser"><i class="mdi mdi-account-remove "></i>
                Expired Users</a></li>


          </ul>
        </div>
      </li>

      <li class="nav-item">
        <a class="nav-link" style="padding: 14px;" data-toggle="collapse" href="#user-menu" aria-expanded="false"
          aria-controls="user-menu">
          <i class="mdi mdi-account-multiple-outline dynamic-color-icon"></i>
          <span class="menu-title">Team Management</span>
          <i class="menu-arrow"></i>
        </a>
        <div class="collapse" id="user-menu">
          <ul class="nav flex-column sub-menu" style="padding: 0.25rem 0 0; list-style: none !important;">
            <li class="nav-item">
              <a class="nav-link" href="/AdminTeam">
                <i class="mdi mdi-account-outline"></i> All Staff
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/Allstaff">
                <i class="mdi mdi-account-multiple-plus"></i> Add Team Member
              </a>
            </li>
          </ul>
        </div>
      </li>

      <li class="nav-item">
        <a class="nav-link" style="padding: 14px;" data-toggle="collapse" href="#package-menu" aria-expanded="false"
          aria-controls="user-menu">
          <i class="mdi mdi-package-variant-closed dynamic-color-icon"></i>
          <span class="menu-title">Service Packages</span>
          <i class="menu-arrow"></i>
        </a>
        <div class="collapse" id="package-menu">
          <ul class="nav flex-column sub-menu" style="padding: 0.25rem 0 0; list-style: none !important;">
            <li class="nav-item">
              <a class="nav-link" href="/package">
                <i class="mdi mdi-view-list"></i> View All Packages
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/AddPackages">
                <i class="mdi mdi-plus-box"></i> Add New Packages
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link text-center" href="/request">
                <i class="mdi mdi-inbox-arrow-down"></i> Package Requests
              </a>
            </li>
          </ul>
        </div>
      </li>

      <!-- User equipment -->
      <li class="nav-item">
        <a class="nav-link" data-toggle="collapse" href="#equipmentMenu" aria-expanded="false" aria-controls="ui-basic">
          <i class="mdi mdi-toolbox-outline dynamic-color-icon"></i>
          <span class="menu-title">User Equipment</span>
          <i class="menu-arrow" style="margin-left:10px;"></i>
        </a>
        <div class="collapse" id="equipmentMenu">
          <ul class="nav flex-column sub-menu" style="padding: 0.25rem 0 0; list-style: none !important;">
            <li class="nav-item">
              <a class="nav-link" href="/ViewAllEquipments">
                <i class="mdi mdi-format-list-bulleted"></i> All Stock
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/AddNewEquipment">
                <i class="mdi mdi-plus-box-outline"></i> Add Stock
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/userEquipment">
                <i class="mdi mdi-account-cog-outline"></i> Assign Equipment
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/EquipmentStatus">
                <i class="mdi mdi-clipboard-check-outline"></i> Equipment Status
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/RecoveryManagement">
                <i class="mdi mdi-restore"></i> Recovery Management
              </a>
            </li>
          </ul>
        </div>
      </li>

      <!-- User equipment -->

      <!-- ssssssss --> <!-- ssssssss --> <!-- ssssssss --> <!-- ssssssss -->
      <li class="nav-item">
        <a class="nav-link"  data-toggle="collapse" href="#Customize-menu" aria-expanded="false"
          aria-controls="user-menu">
          <i class="mdi mdi-palette-outline dynamic-color-icon"></i>
          <span class="menu-title" >System Setting</span>
          <i class="menu-arrow" ></i>
        </a>
        <div class="collapse" id="Customize-menu">
          <ul class="nav flex-column sub-menu" style="padding: 0.25rem 0 0; list-style: none !important;">
            
<li class="nav-item">
  <!-- Single clickable area for toggling dropdown -->
  <a class="nav-link d-flex align-items-center gap-1" data-bs-toggle="collapse" href="#userDashboardMenu"
    aria-expanded="false" aria-controls="userDashboardMenu" style="color: white;">
    <i class="mdi mdi-view-dashboard-edit" style="color: white;"></i>
    User Dashboard
    <i class="menu-arrow" style="color: white; margin-left: auto;"></i>
  </a>

  <div class="collapse" id="userDashboardMenu">
    <ul class="nav flex-column sub-menu">
      <li class="nav-item">
        <a class="nav-link" href="/ColorSetting">
          <i class="mdi mdi-palette menu-icon" style="font-size:16px; color: white;"></i>
          Color Settings
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/BackGroundSettings">
          <i class="mdi mdi-image-area menu-icon" style="font-size:16px; color: white;"></i>
          Background Settings
        </a>
      </li>
    </ul>
  </div>
</li>

           

            <li class="nav-item">
              <a class="nav-link" href="/BrandingPage">
                <i class="mdi mdi-image-marker-outline"></i> Slider images
              </a>
            </li>
            
              
            <li class="nav-item">
  <!-- Single clickable area for toggle -->
  <a class="nav-link d-flex align-items-center" data-bs-toggle="collapse" href="#headerFooterMenu"
     aria-expanded="false" aria-controls="headerFooterMenu" style="color: white; margin-left: auto;">
    <i class="mdi mdi-format-align-top"></i>
    Edit Footer & Header
    <i class="menu-arrow" style="color: white; margin-left: 5px;"></i>
  </a>

  <div class="collapse" id="headerFooterMenu">
    <ul class="nav flex-column sub-menu">
      <li class="nav-item">
        <a class="nav-link" href="/NavbarSetting">
          <i class="mdi mdi-view-headline" style="font-size:16px; color: white;"></i> Navbar Setting
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/FooterSetting">
          <i class="mdi mdi-format-align-bottom" style="font-size:16px; color: white;"></i> Footer Setting
        </a>
      </li>
    </ul>
  </div>
</li>



          </ul>
        </div>
      </li>


      <li class="nav-item">
        <a class="nav-link" href="/review">
          <i class="bi bi-star dynamic-color-icon"></i>
          <span class="menu-title pl-2">Reviews</span>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/UserComplaint">
          <i class="bi bi-chat-right-quote dynamic-color-icon"></i>
          <span class="menu-title pl-2">User Complaint</span>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" style="padding: 14px;" data-toggle="collapse" href="#charts" aria-expanded="false"
          aria-controls="charts">
          <i class="bi bi-coin dynamic-color-icon"></i>
          <span class="menu-title">Earning system</span>
          <i class="menu-arrow"></i>
        </a>
        <div class="collapse" id="charts">
          <ul class="nav flex-column sub-menu" style="padding: 0.25rem 0 0; list-style: none !important;">
            <li class="nav-item"> <a class="nav-link" href="/addtask"><i class="mdi mdi-calendar-plus"></i>Add Task</a>
            </li>
            <li class="nav-item"> <a class="nav-link" href="/CompletedTask"><i class="mdi mdi-calendar-check"></i>
                Completed Task</a></li>
          </ul>
        </div>
      </li>

      <li class="nav-item">
        <a class="nav-link" style="padding: 14px;" data-toggle="collapse" href="#message" aria-expanded="false"
          aria-controls="message">
          <i class="mdi mdi-message-text-outline dynamic-color-icon"></i>
          <span class="menu-title ">Notification Center</span>
          <i class="menu-arrow"></i>
        </a>
        <div class="collapse" id="message">
          <ul class="nav flex-column sub-menu" style="padding: 0.25rem 0 0; list-style: none !important;">
            <li class="nav-item"> <a class="nav-link" href="/Promotions"><i
                  class="mdi mdi-message-image"></i>Promotions</a></li>
            <!-- <li class="nav-item"> <a class="nav-link" href="/Services"><i class="mdi mdi-message-alert"></i>Service Alert</a></li> -->
          </ul>
        </div>
      </li>
      <li class="nav-item">
        <a class="nav-link" style="padding: 14px;" data-toggle="collapse" href="#billing-payments" aria-expanded="false"
          aria-controls="charts">
          <i class="bi bi-cash-stack dynamic-color-icon"></i>
          <span class="menu-title">Billing-Payments</span>
          <i class="menu-arrow"></i>
        </a>
        <div class="collapse" id="billing-payments">
          <ul class="nav flex-column sub-menu" style="padding: 0.25rem 0 0; list-style: none !important;">
            <li class="nav-item">
              <a class="nav-link" href="/paymentshistory">
                <i class="fas fa-history text-info me-2"></i>Payment History
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/pandingpayments">
                <i class="fas fa-clock text-warning me-2"></i>Pending Payments
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/paid-users-page">
                <i class="fas fa-check-circle text-success me-2"></i>Paid Users
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/pending-by-user">
                <i class="fas fa-user-clock text-warning me-2"></i>Pending by User
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/packages-by-status-page">
                <i class="bi bi-box-seam"></i>Packages Status
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/all-package-requests-page">
                <i class="bi bi-clipboard-data"></i>All Requests
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/manual-package-requests-page">
                <i class="bi bi-hand-index"></i>Manual Requests
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/unpaid-vs-active-page">
                <i class="bi bi-graph-up"></i>Payment Analysis
              </a>
            </li>
          </ul>
        </div>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/">
          <i class="mdi mdi-logout dynamic-color-icon"></i>
          <span class="menu-title pl-2">Logout</span>
        </a>
      </li>
    </ul>
  </nav>
  <% } %>

    <!-- Package -->

    <!-- User --> <!-- User --> <!-- User --> <!-- User -->
    <% if(isUser){ %>
      <nav class="sidebar sidebar-offcanvas" id="sidebar">
        <ul class="nav">
          <li class="nav-item">
            <a class="nav-link" href="/index">
              <i class="icon-grid menu-icon dynamic-color-icon"></i>
              <span class="menu-title">Dashboard</span>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="/package">
              <i class="mdi mdi-cast dynamic-color-icon"></i>
              <span class="menu-title pl-2">All Packages</span>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="/History">
              <i class="mdi mdi-alarm-multiple dynamic-color-icon"></i>
              <span class="menu-title pl-2">History</span>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="/complaint">
              <i class="bi bi-wallet2 dynamic-color-icon"></i>
              <span class="menu-title pl-2">Wallet </span>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="/profile">
              <i class="mdi mdi-account dynamic-color-icon"></i>
              <span class="menu-title pl-2">Profile</span>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="/contactus">
              <i class="mdi mdi-phone dynamic-color-icon"></i>
              <span class="menu-title pl-2">Contact Us</span>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="/changepassword" style="padding: 13px 7px;">
              <i class="bi bi-house-lock dynamic-color-icon"></i>
              <span class="menu-title pl-2">Change Wifi Password</span>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="/">
              <i class="mdi mdi-logout dynamic-color-icon"></i>
              <span class="menu-title pl-2">Logout</span>
            </a>
          </li>


        </ul>
      </nav>
      <% } %>

      
         <style>
              .sub-menu {
                padding-left: 0 !important;
                margin-left: 0 !important;
                list-style: none;
              }
            
        
        /* Enhanced sidebar icons */
        .nav-link i.text-warning {
          color: #ffc107 !important;
        }
        
        .nav-link i.text-info {
          color: #17a2b8 !important;
        }
        
        .nav-link i.text-success {
          color: #28a745 !important;
        }
        
        /* Icon spacing and sizing */
        .nav-link i.me-2 {
          margin-right: 0.5rem !important;
          font-size: 1rem;
        }
        
        /* Hover effects for enhanced icons */
        .nav-link:hover i.text-warning {
          color: #e0a800 !important;
        }
        
        .nav-link:hover i.text-info {
          color: #138496 !important;
        }
        
        .nav-link:hover i.text-success {
          color: #1e7e34 !important;
        }
      </style>

        <script>
          // Sidebar Toggle for Mobile
          function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');

            if (sidebar && overlay) {
              sidebar.classList.toggle('active');
              overlay.classList.toggle('active');
            }
          }

          // Auto-hide sidebar when clicking on links (mobile)
          document.addEventListener('DOMContentLoaded', function () {
            if (window.innerWidth <= 991) {
              const sidebarLinks = document.querySelectorAll('.sidebar .nav-link');
              sidebarLinks.forEach(link => {
                link.addEventListener('click', function () {
                  if (!this.getAttribute('data-toggle')) {
                    toggleSidebar();
                  }
                });
              });
            }
          });

          // Handle window resize
          window.addEventListener('resize', function () {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');

            if (window.innerWidth > 991) {
              if (sidebar) sidebar.classList.remove('active');
              if (overlay) overlay.classList.remove('active');
            }
          });
        </script>

        <!-- User --> <!-- User --> <!-- User --> <!-- User --> <!-- User --> <!-- User --> <!-- User --> <!-- User -->