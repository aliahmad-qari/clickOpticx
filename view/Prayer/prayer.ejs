<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Prayer</title>
  <!-- plugins:css -->
  <link rel="stylesheet" href="vendors/feather/feather.css">
  <link rel="stylesheet" href="vendors\ti-icons\css\themify-icons.css">
  <link rel="stylesheet" href="vendors/css/vendor.bundle.base.css">
  <!-- endinject -->
  <!-- Plugin css for this page -->
  <link rel="stylesheet" href="vendors/datatables.net-bs4/dataTables.bootstrap4.css">
  <link rel="stylesheet" href="vendors\ti-icons\css\themify-icons.css">
  <link rel="stylesheet" type="text/css" href="js/select.dataTables.min.css">
  <!-- End plugin css for this page -->
  <!-- inject:css -->
  <link rel="stylesheet" href="css/vertical-layout-light/style.css">
  <!-- endinject -->
  <link rel="shortcut icon" href="images/favicon.png" />

  <!-- Material Design Icons CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">

<link href="https://cdn.jsdelivr.net/npm/@mdi/font@7.2.96/css/materialdesignicons.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
</head>
<body>
  <div class="container-scroller">
    <!-- partial:partials/_navbar -->
    <%- include ('../partials/_navbar.ejs') %>
    <div class="container-fluid page-body-wrapper">
    <!-- partial:partials/_navbar -->
    <nav class="sidebar sidebar-offcanvas" id="sidebar">
        <ul class="nav">
            <li class="nav-item">
                <a class="nav-link" href="/index">
                    <i class="icon-grid menu-icon"></i>
                    <span class="menu-title">Dashboard</span>
                </a>
            </li>
            
    
            <li class="nav-item">
                <a class="nav-link" href="/package">
                    <i class="mdi mdi-cast"></i>
                    <span class="menu-title pl-2">All Packages</span>
                </a>
            </li>
    
            <li class="nav-item">
                <a class="nav-link" href="/History">
                    <i class="mdi mdi-alarm-multiple"></i>
                    <span class="menu-title pl-2">History</span>
                </a>
            </li>

            <li class="nav-item">
                <a class="nav-link" href="/complaint">
                    <i class="bi bi-wallet2"></i>
                    <span class="menu-title pl-2">Wallet </span>
                </a>
            </li>

            
          <li class="nav-item">
            <a class="nav-link" href="/profile">
                <i class="mdi mdi-account"></i>
                <span class="menu-title pl-2">Profile</span>
            </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="/contactus">
              <i class="mdi mdi-phone"></i>
              <span class="menu-title pl-2">Contact Us</span>
          </a>
      </li>

        <li class="nav-item">
        <a class="nav-link" href="/changepassword">
          <i class="bi bi-house-lock"></i>
          <span class="menu-title pl-2">Change Wifi Password</span>
        </a>
      </li>

            <li class="nav-item">
                <a class="nav-link" href="/logout">
                    <i class="mdi mdi-logout"></i>
                    <span class="menu-title pl-2">Logout</span>
                </a>
            </li>
        </ul>
    </nav>
<!-- NavBar End -->

<div class="main-panel" style="background-image: url('images/namz bg.jpg'); background-size: cover; background-position: center;">
  

        <div class="content-wrapper">
            <!-- Hero start -->
            <div class="container-fluid" style="padding: 0%;">


                <div class="container mt-4 p-0">
                    <h2 class="text-center">بِسْمِ ٱللّٰهِ ٱلرَّحْمٰنِ ٱلرَّحِيْمِ</h2>
                    <div class="p-3">
                        <h4 class="text-center" id="city-name">Enter City</h4>
                
                        <!-- Search Input -->
                        <div class="input-group mb-3">
                            <input type="text" id="city-input" class="form-control" placeholder="Enter city name" aria-label="City name" style="border-radius: 12px; margin-right: 10px;">
                            <button class="btn btn-primary" onclick="fetchPrayerTimings()">Search</button>
                        </div>
                
                        <div class="text-center my-2">
                            <p id="date">Loading...</p>
                            <p id="qibla">Qibla Direction: --°</p>
                        </div>
                
                        <ul class="list-group" style="border-radius: 22px;">
                            <li class="list-group-item d-flex justify-content-between bg-dark text-white"><span>Fajr</span><span id="fajr">--:--</span></li>
                            <li class="list-group-item d-flex justify-content-between bg-dark text-white"><span>Sunrise</span><span id="sunrise">--:--</span></li>
                            <li class="list-group-item d-flex justify-content-between bg-dark text-white"><span>Dhuhr</span><span id="dhuhr">--:--</span></li>
                            <li class="list-group-item d-flex justify-content-between bg-dark text-white"><span>Asr</span><span id="asr">--:--</span></li>
                            <li class="list-group-item d-flex justify-content-between bg-dark text-white"><span>Maghrib</span><span id="maghrib">--:--</span></li>
                            <li class="list-group-item d-flex justify-content-between bg-dark text-white"><span>Isha</span><span id="isha">--:--</span></li>
                        </ul>
                
                        <p id="error-message" class="text-danger text-center mt-2"></p>
                    </div>
                </div>
                
                <script>
                    document.getElementById("city-input").addEventListener("keypress", function (event) {
                        if (event.key === "Enter") {
                            fetchPrayerTimings();
                        }
                    });
                
                    function fetchPrayerTimings() {
                        const city = document.getElementById("city-input").value.trim();
                        const country = "Pakistan";
                
                        if (!city) {
                            document.getElementById("error-message").textContent = "Please enter a city name.";
                            return;
                        } else {
                            document.getElementById("error-message").textContent = "";
                        }
                
                        document.getElementById("city-name").textContent = city;
                        const apiUrl = `https://api.aladhan.com/v1/timingsByCity?city=${city}&country=${country}&method=2`;
                
                        fetch(apiUrl)
                            .then(response => {
                                if (!response.ok) {
                                    throw new Error(`HTTP error! Status: ${response.status}`);
                                }
                                return response.json();
                            })
                            .then(data => {
                                const timings = data.data.timings;
                
                                function convertTo12Hour(time) {
                                    let [hours, minutes] = time.split(":");
                                    let period = "AM";
                                    hours = parseInt(hours, 10);
                
                                    if (hours >= 12) {
                                        period = "PM";
                                        if (hours > 12) hours -= 12;
                                    } else if (hours === 0) {
                                        hours = 12;
                                    }
                
                                    return `${hours}:${minutes} ${period}`;
                                }
                
                                document.getElementById("fajr").textContent = convertTo12Hour(timings.Fajr);
                                document.getElementById("sunrise").textContent = convertTo12Hour(timings.Sunrise);
                                document.getElementById("dhuhr").textContent = convertTo12Hour(timings.Dhuhr);
                                document.getElementById("asr").textContent = convertTo12Hour(timings.Asr);
                                document.getElementById("maghrib").textContent = convertTo12Hour(timings.Maghrib);
                                document.getElementById("isha").textContent = convertTo12Hour(timings.Isha);
                
                                document.getElementById("date").textContent = `Date: ${new Date().toDateString()}`;
                
                                fetchQiblaDirection(city, country);
                            })
                            .catch(error => {
                                document.getElementById("error-message").textContent = "Failed to fetch prayer timings. Please try again.";
                                console.error("Error fetching prayer timings:", error);
                            });
                    }
                
                    function fetchQiblaDirection(city, country) {
                        const qiblaApiUrl = `https://api.aladhan.com/v1/qibla/${city},${country}`;
                
                        fetch(qiblaApiUrl)
                            .then(response => {
                                if (!response.ok) {
                                    throw new Error(`HTTP error! Status: ${response.status}`);
                                }
                                return response.json();
                            })
                            .then(data => {
                                document.getElementById("qibla").textContent = `Qibla Direction: ${data.data.direction.toFixed(2)}°`;
                            })
                            .catch(error => {
                                document.getElementById("qibla").textContent = "Qibla Direction: --°";
                                console.error("Error fetching Qibla direction:", error);
                            });
                    }
                </script>
                
                
                
</div>
</div>

</div>
</div>
</div>           



<%- include('../partials/_footer.ejs') %>
  <!-- plugins:js -->
  <script src="vendors/js/vendor.bundle.base.js"></script>
  <!-- endinject -->
  <!-- Plugin js for this page -->
  <script src="vendors/chart.js/Chart.min.js"></script>
  <script src="vendors/datatables.net/jquery.dataTables.js"></script>
  <script src="vendors/datatables.net-bs4/dataTables.bootstrap4.js"></script>
  <script src="js/dataTables.select.min.js"></script>

  <!-- End plugin js for this page -->
  <!-- inject:js -->
  <script src="js/off-canvas.js"></script>
  <script src="js/hoverable-collapse.js"></script>
  <script src="js/template.js"></script>
  <script src="js/settings.js"></script>
  <script src="js/todolist.js"></script>
  <!-- endinject -->
  <!-- Custom js for this page-->
  <script src="js/dashboard.js"></script>
  <script src="js/Chart.roundedBarCharts.js"></script>
  <!-- End custom js for this page-->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>

